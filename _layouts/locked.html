<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å—ä¿æŠ¤çš„é¡µé¢</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background: #f0f2f5; display: flex; align-items: center; justify-content: center; height: 100vh; margin: 0; }
        .login-box { background: white; padding: 2rem; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); width: 100%; max-width: 380px; text-align: center; }
        h2 { margin-bottom: 1.5rem; color: #333; font-weight: 600; }
        input[type="password"] { width: 100%; padding: 12px; margin-bottom: 1rem; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; font-size: 16px; outline: none; transition: border 0.2s; }
        input[type="password"]:focus { border-color: #007bff; }
        button { width: 100%; padding: 12px; background: #007bff; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 16px; font-weight: 600; transition: background 0.2s; }
        button:hover { background: #0056b3; }
        .error { color: #dc3545; font-size: 14px; margin-top: 10px; display: none; }
        #protected-content { display: none; margin-top: 20px; text-align: left; line-height: 1.6; color: #444; word-break: break-word; }
        .hidden-data { display: none; }
    </style>
</head>
<body>

<div class="login-box">
    <div id="login-form">
        <h2>ğŸ”’ è¯·è¾“å…¥è®¿é—®å¯†é’¥</h2>
        <input type="password" id="passwordInput" placeholder="è¾“å…¥ 16 ä½å¯†é’¥..." autofocus>
        <button onclick="attemptUnlock()">è§£ é”</button>
        <div id="errorMsg" class="error">å¯†é’¥é”™è¯¯æˆ–æ•°æ®æŸå</div>
    </div>

    <div id="protected-content"></div>
</div>

<input type="hidden" id="iv-string" value="00000000000000000000000000000000">

<input type="hidden" id="ciphertext-base64" value="è¯·åœ¨è¿™é‡Œç²˜è´´ä½ çš„Base64å¯†æ–‡">
<script>
    function attemptUnlock() {
        const password = document.getElementById('passwordInput').value;
        const ivString = document.getElementById('iv-string').value;
        const ciphertext = document.getElementById('ciphertext-base64').value;
        const errorMsg = document.getElementById('errorMsg');
        const contentDiv = document.getElementById('protected-content');
        const loginForm = document.getElementById('login-form');

        // é‡ç½®çŠ¶æ€
        errorMsg.style.display = 'none';

        try {
            // æ ¸å¿ƒé€»è¾‘ï¼šæ–¹æ¡ˆ A (å…¨éƒ¨æŒ‰ UTF-8 æ–‡æœ¬å¤„ç†)
            const key = CryptoJS.enc.Utf8.parse(password);
            const iv = CryptoJS.enc.Utf8.parse(ivString); // å…³é”®ä¿®æ­£ç‚¹ï¼

            const decrypted = CryptoJS.AES.decrypt(ciphertext, key, {
                iv: iv,
                mode: CryptoJS.mode.CBC,
                padding: CryptoJS.pad.Pkcs7
            });

            const resultString = decrypted.toString(CryptoJS.enc.Utf8);

            // éªŒè¯è§£å¯†ç»“æœ
            if (resultString.length > 0) {
                // æˆåŠŸï¼éšè—ç™»å½•æ¡†ï¼Œæ˜¾ç¤ºå†…å®¹
                loginForm.style.display = 'none';
                contentDiv.innerHTML = resultString; // æ”¯æŒ HTML å†…å®¹
                contentDiv.style.display = 'block';
            } else {
                throw new Error("è§£å¯†ç»“æœä¸ºç©º");
            }

        } catch (e) {
            console.error("Decryption failed:", e);
            errorMsg.style.display = 'block';
            // åŠ¨ç”»éœ‡åŠ¨æç¤ºï¼ˆå¯é€‰ï¼‰
            document.querySelector('.login-box').animate([
                { transform: 'translateX(0)' },
                { transform: 'translateX(-5px)' },
                { transform: 'translateX(5px)' },
                { transform: 'translateX(0)' }
            ], { duration: 300 });
        }
    }

    // æ”¯æŒå›è½¦é”®æäº¤
    document.getElementById('passwordInput').addEventListener('keypress', function (e) {
        if (e.key === 'Enter') attemptUnlock();
    });
</script>

</body>
</html>